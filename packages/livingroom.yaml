switch:
  - platform: template
    switches:
      livingroom_ps5:
        friendly_name: PS5
        icon_template: mdi:sony-playstation
        value_template: >
          {{     is_state('switch.livingroom_ps5', 'on')
             and is_state('media_player.livingroom_tv', 'on')
             and is_state('media_player.livingroom_receiver', 'on')
             and is_state_attr('media_player.livingroom_tv', 'source', 'HDMI2')
             and is_state_attr('media_player.livingroom_receiver', 'source', 'Video 3') }}
        availability_template: >
          {{     not is_state('switch.livingroom_ps5', 'unavailable')
             and not is_state('media_player.livingroom_tv', 'unavailable')
             and not is_state('media_player.livingroom_receiver', 'unavailable') }}
        turn_on:
          - parallel:
              - service: switch.turn_on
                entity_id: switch.livingroom_ps5
              - service: media_player.turn_on
                entity_id:
                  - media_player.livingroom_tv
                  - media_player.livingroom_receiver
          - delay: 5
          - parallel:
            - service: media_player.select_source
              entity_id: media_player.livingroom_tv
              data:
                source: HDMI2
            - service: media_player.select_source
              entity_id: media_player.livingroom_receiver
              data:
                source: Video 3
        turn_off:
          - service: switch.turn_off
            entity_id: switch.livingroom_ps5
          - service: media_player.turn_off
            entity_id: 
              - media_player.livingroom_tv
              - media_player.livingroom_receiver