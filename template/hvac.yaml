- sensor:
    - name: target_temp_heating
      state: >-
        {% if not is_state('person.mike', 'home') %}
          {{ states('input_number.climate_heat_away_temp') }}
        {% elif is_state('input_boolean.sleep_mode', 'on') %}
          {{ states('input_number.climate_heat_asleep_temp') }}
        {% else %}
          {{ states('input_number.climate_heat_home_temp') }}
        {% endif %}
    - name: target_temp_cooling
      state: >-
        {% if not is_state('person.mike', 'home') %}
          {{ states('input_number.climate_cool_away_temp') }}
        {% elif is_state('input_boolean.sleep_mode', 'on') %}
          {{ states('input_number.climate_cool_asleep_temp') }}
        {% else %}
          {{ states('input_number.climate_cool_home_temp') }}
        {% endif %}
    - name: hvac_current_temperature
      state: "{{ state_attr('climate.thermostat', 'current_temperature') }}"
- binary_sensor:
    - name: hvac_cool_on
      state: "{{ is_state_attr('climate.thermostat', 'hvac_action', 'cooling') }}"
    - name: hvac_heat_on
      state: "{{ is_state_attr('climate.thermostat', 'hvac_action', 'heating') }}"
    - name: hvac_only_fan_on
      state: "{{ is_state_attr('climate.thermostat', 'hvac_action', 'idle') and is_state_attr('climate.thermostat', 'fan_state', 'Running / running low') }}"
