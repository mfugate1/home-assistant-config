- alias: Magic Cube - Living Room - Set Last Known Side
  id: magic_cube_livingroom_set_last_known_side
  trigger:
    platform: state
    entity_id: sensor.magic_cube_action_side
    not_to: 'None'
  action:
    service: input_number.set_value
    entity_id: input_number.magic_cube_livingroom_last_known_side
    data:
      value: "{{ trigger.to_state.state }}"

- alias: Magic Cube - Living Room - Tap
  id: magic_cube_livingroom_tap
  trigger:
    platform: device
    domain: mqtt
    device_id: a17597ba38cebb7a54cc0271c367dfc8
    type: action
    subtype: tap
    discovery_id: 0x00158d000802ad48 action_tap
  action:
    parallel:
      - service: switch.toggle
        target:
          entity_id: >-
            {% if states('input_number.magic_cube_livingroom_last_known_side') | int == 0 %}
              switch.livingroom_netflix
            {% elif states('input_number.magic_cube_livingroom_last_known_side') | int == 1 %}
              switch.livingroom_displayplus
            {% elif states('input_number.magic_cube_livingroom_last_known_side') | int == 2 %}
              switch.livingroom_plex
            {% elif states('input_number.magic_cube_livingroom_last_known_side') | int == 3 %}
              switch.livingroom_hulu
            {% elif states('input_number.magic_cube_livingroom_last_known_side') | int == 4 %}
              switch.livingroom_youtube
            {% elif states('input_number.magic_cube_livingroom_last_known_side') | int == 5 %}
              switch.livingroom_ps4
            {% endif %}
      - service: notify.alexa_media_livingroom_echo
        data:
          message: |
            <audio src="soundbank://soundlibrary/alarms/beeps_and_bloops/bell_06"/>
          data:
            type: tts

      # Failure sound <audio src="soundbank://soundlibrary/alarms/beeps_and_bloops/buzz_02"/>