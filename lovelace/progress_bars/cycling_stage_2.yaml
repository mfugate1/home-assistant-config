type: custom:config-template-card
variables:
  CURRENT: states['sensor.cycling_stage_2'].state
  DAYS_REMAINING: Math.ceil((new Date("2021-06-30").getTime() - new Date().getTime()) / (1000*60*60*24)) + 1
  GOAL: 505
entities:
  - sensor.cycling_stage_2
row:
  type: custom:bar-card
  entity: sensor.cycling_stage_2
  icon: mdi:bike
  name: "${'Cycling Stage 2: ' + (parseFloat(CURRENT) >= GOAL ? 'COMPLETE! (' + parseInt(CURRENT) + ' miles)' : parseInt(CURRENT) + ' / ' + GOAL + ' mi (' + DAYS_REMAINING + ' days remaining)')}"
  min: 0
  max: "${GOAL}"
  entity_row: true
  positions:
    value: 'off'
  severity:
    - from: 0
      to: "${GOAL - 0.01}"
      color: darkred
    - from: "${GOAL}"
      to: "${GOAL + 100000}"
      color: darkgreen
  style: |
    bar-card-contentbar {
      font-weight: bold;
      color: gold;
    }
    bar-card-name {
      margin-left: 10px;
    }
    bar-card-currentbar {
      border-radius: 10px;
    }
    bar-card-backgroundbar {
      border-radius: 10px;
    }